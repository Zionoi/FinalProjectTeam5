<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<script th:src="@{/js/studyList.js}"></script>
	<link rel="stylesheet" th:href="@{/css/studyChoice.css}">
    <meta charset="EUC-KR">
    <title>검사 이력</title>
</head>
<body>
    <div th:fragment="studyChoice">
        <div th:if="${choiceStudies != null and !choiceStudies.isEmpty()}">
            <p>환자 ID: <span th:text="${choiceStudies[0].pid}">정보 없음</span></p>
            <p>환자 이름: <span th:text="${choiceStudies[0].pName}">정보 없음</span></p>
        </div>
        
        <div th:if="${choiceStudies == null or choiceStudies.isEmpty()}">
            <p>환자 ID: 정보 없음</p>
            <p>환자 이름: 정보 없음</p>
        </div>

        <table class="dicom-table">
            <thead>
                <tr>
                    <th>상세 보기</th>
                    <th>시리즈 보기</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="study : ${choiceStudies}">
                    <td>
                        <!-- pid로 상세 보기 페이지로 이동 -->
                        <a th:href="@{|/studyList/${study.pid}/patientDetail|}">상세 보기</a>
                    </td>
                    <td>
                        <!-- studyKey로 시리즈 보기 페이지로 이동 -->
                        <a th:href="@{|/studyList/${study.studyKey}/series|}">시리즈 보기</a>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- 페이지네이션 -->
        <div class="pagination">
            <ul>
                <li th:if="${currentPage != null and currentPage > 0}">
                    <a th:href="@{|/studyList/${choiceStudies[0].pid}/patientDetail(page=${currentPage - 1})|}">이전</a>
                </li>
                <li th:each="i : ${#numbers.sequence(0, totalPages != null ? totalPages - 1 : 0)}">
                    <a th:href="@{|/studyList/${choiceStudies[0].pid}/patientDetail(page=${i})|}"
                       th:text="${i + 1}" th:classappend="${i == currentPage} ? 'active' : ''">1</a>
                </li>
                <li th:if="${currentPage != null and totalPages != null and currentPage < totalPages - 1}">
                    <a th:href="@{|/studyList/${choiceStudies[0].pid}/patientDetail(page=${currentPage + 1})|}">다음</a>
                </li>
            </ul>
        </div>
    </div>
</body>
</html>
